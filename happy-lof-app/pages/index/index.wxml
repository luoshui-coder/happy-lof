<!-- pages/index/index.wxml -->
<view class="page">
  <!-- 头部 -->
  <view class="header gradient-primary">
    <view class="header-title">Happy LOF</view>
    <view class="header-subtitle">每日溢价查询 · 把握LOF基金的每一次价值偏离</view>
    <view class="update-time">更新时间：{{updateTime}}</view>
    <view class="toggle-container">
      <switch class="toggle-switch" checked="{{showPaused}}" bindchange="onTogglePaused" color="#ffffff" style="transform: scale(0.7);"/>
      <text class="toggle-label">显示暂停申购</text>
      <view class="help-icon" bindtap="showHelp">?</view>
    </view>
  </view>

  <!-- 内容区域 -->
  <view class="container">
    <!-- 加载状态 -->
    <view wx:if="{{loading}}" class="loading">
      正在获取最新数据...
    </view>

    <!-- 空状态 -->
    <view wx:elif="{{!loading && fundList.length === 0}}" class="empty-state">
      <view class="empty-state-icon">📊</view>
      <view>暂无符合条件的套利机会</view>
    </view>

    <!-- 基金列表 -->
    <view wx:else class="fund-list">
      <fund-card 
        wx:for="{{fundList}}" 
        wx:key="fund_id"
        fund="{{item}}"
        bindcardtap="onFundCardTap"
      />
    </view>
  </view>

  <!-- 刷新按钮 -->
  <view class="refresh-btn gradient-primary" bindtap="onRefresh">
    <text class="refresh-icon">↻</text>
  </view>

  <!-- Help Modal -->
  <view class="modal-mask" wx:if="{{showHelpModal}}" bindtap="closeHelp">
    <view class="modal-content" catchtap="true">
      <view class="close-btn" bindtap="closeHelp">×</view>
      <view class="modal-title">使用帮助</view>
      <view class="modal-body">
        <view class="modal-item">
          <text class="modal-icon">📋</text>
          <text class="modal-text">点击代码：即复制到剪贴板</text>
        </view>
        <view class="modal-item">
          <text class="modal-icon">📈</text>
          <text class="modal-text">背景走势：卡片背景为近30天溢价率走势</text>
        </view>
        <view class="modal-item">
          <text class="modal-icon">⭐</text>
          <view class="modal-text">
            星级规则：基于溢价率、成交额综合评分。
            <text class="modal-subtext">跌幅 > -5% 扣星，跌幅 > -9% 归零。</text>
          </view>
        </view>
        <view class="modal-item">
          <text class="modal-icon">⚠️</text>
          <text class="modal-text">免责声明：数据仅供参考，不构成投资建议。</text>
        </view>
      </view>
    </view>
  </view>
</view>
